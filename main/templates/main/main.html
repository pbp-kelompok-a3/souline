{% extends "base.html" %}
{% load static %}

{% block meta %}
<title>Home | Souline</title>
<style>
  /* Hero gradient background */
  .hero-section {
    background: linear-gradient(135deg, #446178 0%, #91C4C3 100%);
  }
</style>
{% endblock meta %}

{% block content %}
{% include "header.html" %}

<!-- Hero Section -->
<div class="hero-section text-[#FFFBF0] py-16 px-4 text-center mb-12">
  <div class="max-w-4xl mx-auto">
    <h1 class="text-4xl md:text-5xl font-bold mb-4" style="text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);">Welcome to Souline</h1>
    <p class="text-xl md:text-2xl mb-8 opacity-95">Your best guide to find Yoga & Pilates studios, connect with communities, and enhance your well-being.</p>
    <a href="#studios-section" 
       class="inline-block px-8 py-3.5 bg-[#FFA04D] text-[#FFFBF0] rounded-full font-semibold text-lg hover:bg-[#ff8c2e] hover:-translate-y-1 transition-all duration-300 shadow-lg hover:shadow-xl">
      Start Your Journey
    </a>
    <div class="mt-8 animate-bounce">
      <p class="text-white text-3xl">‚Üì</p>
    </div>
  </div>
</div>

<!-- Studios Section -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8" id="studios-section">
  <!-- Section Header -->
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
    <div>
      <h2 class="text-3xl md:text-4xl font-semibold text-[#446178]">
        {% if user.is_authenticated and user.profile.kota %}
          Studios Near You
        {% else %}
          Featured Studios
        {% endif %}
      </h2>
      <p class="text-lg text-[#FFA04D] mt-1">
        {% if user.is_authenticated and user.profile.kota %}
          Discover yoga & pilates studios in {{ user.profile.kota }}
        {% else %}
          Discover amazing yoga & pilates studios in Jabodetabek
        {% endif %}
      </p>
    </div>
    <a href="{% url 'studio:show_studio' %}" 
       class="px-6 py-2.5 bg-[#B4DEBD] text-[#446178] rounded-full font-medium hover:bg-[#91C4C3] hover:-translate-y-0.5 hover:shadow-md transition-all duration-300">
      View All Studios
    </a>
  </div>

  <!-- Carousel -->
  <div class="carousel-container relative py-4" data-carousel="main">
    <!-- Left Arrow -->
    <button class="nav-btn hidden absolute top-1/2 left-2 -translate-y-1/2 w-10 h-10 bg-[#FFF7DD]/95 backdrop-blur-md border-2 border-[#446178] text-[#446178] rounded-full flex items-center justify-center cursor-pointer z-10 opacity-70 hover:bg-[#446178] hover:text-[#FFF7DD] hover:opacity-100 hover:scale-110 active:scale-95 transition-all duration-300 shadow-lg" 
            onclick="scrollCarousel('main', -1)" 
            aria-label="Scroll left">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
    </button>
    
    <!-- Cards Container -->
    <div class="cards-wrapper flex gap-6 overflow-x-auto p-4">
      {% for studio in studios %}
        <div class="studio-card min-w-[320px] max-w-[320px] bg-white rounded-2xl overflow-hidden shadow-md hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 flex-shrink-0">
          <img src="{{ studio.thumbnail }}" alt="{{ studio.nama_studio }}" loading="lazy" class="w-full h-48 object-cover bg-gray-100">
          <div class="p-5">
            <h3 class="text-xl font-semibold text-[#446178] mb-2 leading-tight">{{ studio.nama_studio }}</h3>
            <p class="text-[#91C4C3] font-medium text-sm mb-1">üìç {{ studio.area }}, {{ studio.get_kota_display }}</p>
            <p class="text-gray-600 text-sm mb-1 leading-relaxed">üìç {{ studio.alamat }}</p>
            <p class="text-gray-600 text-sm mb-3 leading-relaxed">üìû {{ studio.nomor_telepon }}</p>
            <a href="{{ studio.gmaps_link }}" target="_blank" rel="noopener" 
               class="inline-block mt-2 px-4 py-2 bg-[#FFA04D] text-white rounded-lg text-sm font-medium hover:bg-[#ff8c2e] hover:scale-105 hover:shadow-md transition-all duration-300">
              View on Google Maps ‚Üí
            </a>
          </div>
        </div>
      {% empty %}
        <div class="w-full text-center py-16 bg-white rounded-2xl m-4">
          <p class="text-gray-400 text-lg">No studios available at the moment.</p>
        </div>
      {% endfor %}
    </div>
    
    <!-- Right Arrow -->
    <button class="nav-btn hidden absolute top-1/2 right-2 -translate-y-1/2 w-10 h-10 bg-[#FFF7DD]/95 backdrop-blur-md border-2 border-[#446178] text-[#446178] rounded-full flex items-center justify-center cursor-pointer z-10 opacity-70 hover:bg-[#446178] hover:text-[#FFF7DD] hover:opacity-100 hover:scale-110 active:scale-95 transition-all duration-300 shadow-lg" 
            onclick="scrollCarousel('main', 1)" 
            aria-label="Scroll right">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
      </svg>
    </button>
  </div>
</div>

<!-- Resources Section -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8" id="resources-section">
  <!-- Section Header -->
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
    <div>
      <h2 class="text-3xl md:text-4xl font-semibold text-[#446178]">
        Resources
      </h2>
      <p class="text-lg text-[#FFA04D] mt-1">
        A guide to discovering your strength.
      </p>
    </div>
    <a href="{% url 'resources:resource_list' %}" 
       class="px-6 py-2.5 bg-[#B4DEBD] text-[#446178] rounded-full font-medium hover:bg-[#91C4C3] hover:-translate-y-0.5 hover:shadow-md transition-all duration-300">
      View All Resources
    </a>
  </div>

  <!-- Carousel -->
  <div class="carousel-container relative py-4" data-carousel="resources">
    <!-- Left Arrow -->
    <button class="nav-btn hidden absolute top-1/2 left-2 -translate-y-1/2 w-10 h-10 bg-[#FFF7DD]/95 backdrop-blur-md border-2 border-[#446178] text-[#446178] rounded-full flex items-center justify-center cursor-pointer z-10 opacity-70 hover:bg-[#446178] hover:text-[#FFF7DD] hover:opacity-100 hover:scale-110 active:scale-95 transition-all duration-300 shadow-lg" 
            onclick="scrollCarousel('resources', -1)" 
            aria-label="Scroll left">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
    </button>
    
    <!-- Cards Container -->
    <div class="cards-wrapper flex gap-6 overflow-x-auto p-4">
      {% for resource in resources %}
        <div class="resource-card min-w-[320px] max-w-[320px] bg-white rounded-2xl overflow-hidden shadow-md hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 flex-shrink-0">
          <div class="relative">
            <img src="{{ resource.thumbnail_url }}" alt="{{ resource.title }}" loading="lazy" class="w-full h-48 object-cover bg-gray-100">
            <div class="absolute top-3 right-3 px-3 py-1 bg-[#446178]/90 text-white text-xs font-semibold rounded-full">
              {{ resource.get_level_display }}
            </div>
          </div>
          <div class="p-5">
            <h3 class="text-xl font-semibold text-[#446178] mb-2 leading-tight line-clamp-2">{{ resource.title }}</h3>
            <p class="text-gray-600 text-sm mb-3 leading-relaxed line-clamp-3">{{ resource.description|truncatewords:20 }}</p>
            <a href="{% url 'resources:resource_detail' resource.id %}" 
               class="inline-block w-full text-center mt-2 px-4 py-2 bg-[#B4DEBD] text-[#446178] rounded-lg text-sm font-medium hover:bg-[#91C4C3] hover:scale-105 hover:shadow-md transition-all duration-300">
              Watch Now ‚Üí
            </a>
          </div>
        </div>
      {% empty %}
        <div class="w-full text-center py-16 bg-white shadow-lg rounded-2xl m-4">
          <p class="text-gray-400 text-lg">No resources available at the moment.</p>
        </div>
      {% endfor %}
    </div>
    
    <!-- Right Arrow -->
    <button class="nav-btn hidden absolute top-1/2 right-2 -translate-y-1/2 w-10 h-10 bg-[#FFF7DD]/95 backdrop-blur-md border-2 border-[#446178] text-[#446178] rounded-full flex items-center justify-center cursor-pointer z-10 opacity-70 hover:bg-[#446178] hover:text-[#FFF7DD] hover:opacity-100 hover:scale-110 active:scale-95 transition-all duration-300 shadow-lg" 
            onclick="scrollCarousel('resources', 1)" 
            aria-label="Scroll right">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
      </svg>
    </button>
  </div>
    
</div>

<!-- Timeline Section -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8" id="timeline-section">
  <!-- Section Header -->
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
    <div>
      <h2 class="text-3xl md:text-4xl font-semibold text-[#446178]">
        Timeline
      </h2>
      <p class="text-lg text-[#FFA04D] mt-1">
        Share your journey with the community
      </p>
    </div>
    <a href="{% url 'timeline:list' %}" 
       class="px-6 py-2.5 bg-[#B4DEBD] text-[#446178] rounded-full font-medium hover:bg-[#91C4C3] hover:-translate-y-0.5 hover:shadow-md transition-all duration-300">
      View All Timelines
    </a>
  </div>

  <!-- Timeline Posts Container -->
  <div class="max-w-3xl mx-auto space-y-4">
    {% for post in posts %}
      <div class="bg-white rounded-2xl shadow-md hover:shadow-xl transition-all duration-300 p-6">
        <!-- Post Header -->
        <div class="flex items-center gap-3 mb-4">
          <div class="w-10 h-10 bg-[#91C4C3] rounded-full flex items-center justify-center text-white font-semibold">
            {{ post.author.username|slice:":1"|upper }}
          </div>
          <div>
            <p class="font-semibold text-[#446178]">{{ post.author.username }}</p>
            <p class="text-sm text-gray-500">{{ post.created_at|timesince }} ago</p>
          </div>
        </div>

        <!-- Post Content -->
        <div class="mb-4">
          <p class="text-gray-700 leading-relaxed">{{ post.text|truncatewords:30 }}</p>
        </div>

        <!-- Post Image (if exists) -->
        {% if post.image %}
          <div class="mb-4 rounded-lg overflow-hidden">
            <img src="{{ post.image.url }}" alt="Post image" class="w-full h-auto max-h-96 object-cover">
          </div>
        {% endif %}

        <!-- Post Stats & Actions -->
        <div class="flex items-center gap-6 text-sm text-gray-600 border-t pt-3">
          <div class="flex items-center gap-2">
            <svg class="w-5 h-5 text-red-500" fill="currentColor" viewBox="0 0 20 20">
              <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"/>
            </svg>
            <span>{{ post.like_count }} {% if post.like_count == 1 %}like{% else %}likes{% endif %}</span>
          </div>
          <div class="flex items-center gap-2">
            <svg class="w-5 h-5 text-[#446178]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
            </svg>
            <span>{{ post.comments.count }} {% if post.comments.count == 1 %}comment{% else %}comments{% endif %}</span>
          </div>
          <a href="{% url 'timeline:post_detail' post.pk %}" class="ml-auto text-[#FFA04D] hover:text-[#ff8c2e] font-medium transition-colors">
            View Post ‚Üí
          </a>
        </div>
      </div>
    {% empty %}
      <div class="bg-white rounded-2xl shadow-lg p-12 text-center">
        <p class="text-gray-400 text-lg">No posts yet. Be the first to share your journey!</p>
      </div>
    {% endfor %}
  </div>

</div>

<!-- Events Section -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8" id="events-section">
  <!-- Section Header -->
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
    <div>
      <h2 class="text-3xl md:text-4xl font-semibold text-[#446178]">
        Events
      </h2>
      <p class="text-lg text-[#FFA04D] mt-1">
        Take a moment to feel your flow
      </p>
    </div>
    <a href="{% url 'events:event_list' %}" 
       class="px-6 py-2.5 bg-[#B4DEBD] text-[#446178] rounded-full font-medium hover:bg-[#91C4C3] hover:-translate-y-0.5 hover:shadow-md transition-all duration-300">
      View All Events
    </a>
  </div>

  <!-- Events Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
    {% for event in events %}
      <div class="event-card bg-white rounded-2xl overflow-hidden shadow-md hover:shadow-2xl hover:-translate-y-2 transition-all duration-300">
        {% if event.poster %}
          <img src="{{ event.poster.url }}" alt="{{ event.name }}" loading="lazy" class="w-full h-56 object-cover bg-gray-100">
        {% else %}
          <div class="w-full h-56 bg-gradient-to-br from-[#91C4C3] to-[#B4DEBD] flex items-center justify-center">
            <svg class="w-20 h-20 text-white/50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
            </svg>
          </div>
        {% endif %}
        <div class="p-5">
          <div class="flex items-center gap-2 mb-3">
            <div class="px-3 py-1 bg-[#FFA04D]/20 text-[#FFA04D] text-xs font-semibold rounded-full">
              {{ event.date|date:"d M Y" }}
            </div>
          </div>
          <h3 class="text-xl font-semibold text-[#446178] mb-2 leading-tight line-clamp-2">{{ event.name }}</h3>
          <p class="text-gray-600 text-sm leading-relaxed line-clamp-3 mb-4">{{ event.description|truncatewords:20 }}</p>
          <a href="{% url 'events:event_list' %}" 
             class="inline-block w-full text-center px-4 py-2 bg-[#B4DEBD] text-[#446178] rounded-lg text-sm font-medium hover:bg-[#91C4C3] hover:scale-105 hover:shadow-md transition-all duration-300">
            Learn More ‚Üí
          </a>
        </div>
      </div>
    {% empty %}
      <div class="col-span-full bg-white rounded-2xl shadow-lg p-12 text-center">
        <svg class="w-16 h-16 mx-auto mb-4 text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
        </svg>
        <p class="text-gray-400 text-lg">No upcoming events at the moment.</p>
        <p class="text-gray-400 text-sm mt-2">Check back later for exciting yoga & pilates events!</p>
      </div>
    {% endfor %}
  </div>

</div>

<!-- Sportswear Section -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8" id="sportswear-section">
  <!-- Section Header -->
  <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6">
    <div>
      <h2 class="text-3xl md:text-4xl font-semibold text-[#446178]">
        Sportswear
      </h2>
      <p class="text-lg text-[#FFA04D] mt-1">
        Stay Active, Stay Stylish
      </p>
    </div>
    <a href="{% url 'sportswear:show_sportswear' %}" 
       class="px-6 py-2.5 bg-[#B4DEBD] text-[#446178] rounded-full font-medium hover:bg-[#91C4C3] hover:-translate-y-0.5 hover:shadow-md transition-all duration-300">
      View All Sportswear
    </a>
  </div>

  <!-- Carousel -->
  <div class="carousel-container relative py-4" data-carousel="sportswear">
    <!-- Left Arrow -->
    <button class="nav-btn hidden absolute top-1/2 left-2 -translate-y-1/2 w-10 h-10 bg-[#FFF7DD]/95 backdrop-blur-md border-2 border-[#446178] text-[#446178] rounded-full flex items-center justify-center cursor-pointer z-10 opacity-70 hover:bg-[#446178] hover:text-[#FFF7DD] hover:opacity-100 hover:scale-110 active:scale-95 transition-all duration-300 shadow-lg" 
            onclick="scrollCarousel('sportswear', -1)" 
            aria-label="Scroll left">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
    </button>
    
    <!-- Cards Container -->
    <div class="cards-wrapper flex gap-6 overflow-x-auto p-4">
      {% for brand in sportswear_brands %}
        <div class="sportswear-card min-w-[320px] max-w-[320px] bg-white rounded-2xl overflow-hidden shadow-md hover:shadow-2xl hover:-translate-y-2 transition-all duration-300 flex-shrink-0">
          <!-- Brand Logo/Thumbnail -->
          <div class="h-48 bg-gradient-to-br from-[#FFF7DD] to-[#B4DEBD] flex items-center justify-center p-6">
            {% if brand.thumbnail_url %}
              <img src="{{ brand.thumbnail_url }}" alt="{{ brand.brand_name }}" loading="lazy" class="max-w-full max-h-full object-contain">
            {% else %}
              <div class="text-center">
                <svg class="w-20 h-20 mx-auto mb-2 text-[#446178]/30" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"/>
                </svg>
                <p class="text-2xl font-bold text-[#446178]">{{ brand.brand_name }}</p>
              </div>
            {% endif %}
          </div>
          <div class="p-5">
            <h3 class="text-xl font-semibold text-[#446178] mb-2 leading-tight">{{ brand.brand_name }}</h3>
            <p class="text-gray-600 text-sm mb-4 leading-relaxed line-clamp-3">{{ brand.description|truncatewords:20 }}</p>
            <a href="{{ brand.link }}" target="_blank" rel="noopener" 
               class="inline-block w-full text-center mt-2 px-4 py-2 bg-[#FFA04D] text-white rounded-lg text-sm font-medium hover:bg-[#ff8c2e] hover:scale-105 hover:shadow-md transition-all duration-300">
              Shop Now ‚Üí
            </a>
          </div>
        </div>
      {% empty %}
        <div class="w-full text-center py-16 bg-white shadow-lg rounded-2xl m-4">
          <p class="text-gray-400 text-lg">No sportswear brands available at the moment.</p>
        </div>
      {% endfor %}
    </div>
    
    <!-- Right Arrow -->
    <button class="nav-btn hidden absolute top-1/2 right-2 -translate-y-1/2 w-10 h-10 bg-[#FFF7DD]/95 backdrop-blur-md border-2 border-[#446178] text-[#446178] rounded-full flex items-center justify-center cursor-pointer z-10 opacity-70 hover:bg-[#446178] hover:text-[#FFF7DD] hover:opacity-100 hover:scale-110 active:scale-95 transition-all duration-300 shadow-lg" 
            onclick="scrollCarousel('sportswear', 1)" 
            aria-label="Scroll right">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
      </svg>
    </button>
  </div>
    
</div>

<script>
  // Smooth scroll to section
  document.addEventListener('DOMContentLoaded', function() {
    const smoothScrollLinks = document.querySelectorAll('a[href^="#"]');
    
    smoothScrollLinks.forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        
        const targetId = this.getAttribute('href');
        const targetElement = document.querySelector(targetId);
        
        if (targetElement) {
          targetElement.scrollIntoView({
            behavior: 'smooth',
            block: 'start'
          });
        }
      });
    });
  });

  function scrollCarousel(carouselId, direction) {
    const carousel = document.querySelector(`[data-carousel="${carouselId}"]`);
    const wrapper = carousel.querySelector('.cards-wrapper');
    const cardWidth = 320 + 24;
    const scrollAmount = cardWidth * 2;
    
    wrapper.scrollBy({
      left: direction * scrollAmount,
      behavior: 'smooth'
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    const carousels = document.querySelectorAll('.carousel-container');
    
    carousels.forEach(carousel => {
      const wrapper = carousel.querySelector('.cards-wrapper');
      const leftBtn = carousel.querySelector('.nav-btn:first-of-type');
      const rightBtn = carousel.querySelector('.nav-btn:last-of-type');
      
      function updateButtons() {
        const canScrollLeft = wrapper.scrollLeft > 10;
        const canScrollRight = wrapper.scrollLeft < (wrapper.scrollWidth - wrapper.clientWidth - 10);
        
        leftBtn.classList.toggle('hidden', !canScrollLeft);
        rightBtn.classList.toggle('hidden', !canScrollRight);
      }
      
      updateButtons();
      wrapper.addEventListener('scroll', updateButtons);
      window.addEventListener('resize', updateButtons);
    });
  });

  document.addEventListener('keydown', function(e) {
    const focusedCarousel = document.querySelector('.carousel-container:hover');
    if (!focusedCarousel) return;
    
    const carouselId = focusedCarousel.getAttribute('data-carousel');
    
    if (e.key === 'ArrowLeft') {
      scrollCarousel(carouselId, -1);
    } else if (e.key === 'ArrowRight') {
      scrollCarousel(carouselId, 1);
    }
  });
</script>

{% include "footer.html" %}
{% endblock content %}