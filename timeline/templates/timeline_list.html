{% extends "base.html" %}
{% load static %}

{% block title %}Timeline | SoulLine{% endblock title %}

{% block content %}
  {% include "header.html" %}

  <div class="max-w-3xl mx-auto py-10 px-4">
    <h1 class="text-3xl font-bold text-[#2E4057] text-center">Community Timeline</h1>

    <!-- Create Post -->
    {% if user.is_authenticated %}
      <form id="postForm" method="post" enctype="multipart/form-data"
            action="{% url 'timeline:create' %}"
            class="bg-card-bg p-5 rounded-2xl shadow-md space-y-3">
        {% csrf_token %}
        {{ post_form.text }}
        <div class="flex flex-col sm:flex-row gap-3">
          {{ post_form.image }}
          {{ post_form.video_url }}
        </div>
        <button type="submit"
                class="bg-highlight-orange text-white font-semibold px-5 py-2 rounded-lg hover:bg-[#ff8c2e] transition">
          Post
        </button>
        <div id="postErrors" class="text-red-600 text-sm mt-2 hidden"></div>
      </form>
    {% else %}
      <p class="text-center text-dark-blue py-10">
        Please <a href="{% url 'users:login' %}" class="text-highlight-orange underline">log in</a> to post.
      </p>
    {% endif %}

    <!-- Timeline Feed -->
    <section id="posts" class="mt-8 space-y-6">
      {% for post in posts %}
        {% include "timeline/_post.html" %}
      {% empty %}
        <p class="text-[#F48C06] mt-2 text-lg text-center">No posts yet. Be the first!</p>
      {% endfor %}
    </section>

    <!-- Pagination -->
    <div class="flex justify-center mt-8 space-x-4 text-dark-blue font-small">
      {% if posts.has_previous %}
        <a href="?page={{ posts.previous_page_number }}" class="hover:text-highlight-orange">← Prev</a>
      {% endif %}
      <span>Page {{ posts.number }} of {{ posts.paginator.num_pages }}</span>
      {% if posts.has_next %}
        <a href="?page={{ posts.next_page_number }}" class="hover:text-highlight-orange">Next →</a>
      {% endif %}
    </div>
  </div>

  <!-- <script src="{% static 'timeline/timeline.js' %}"></script> -->
{% endblock content %}
